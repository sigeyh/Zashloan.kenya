<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Zash Loan Disbursement</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-[#FF4E50] via-[#FF6A5C] to-[#FF7C65] min-h-screen text-white flex items-center justify-center relative px-4">

  <!-- Logo -->
  <div class="absolute top-4 left-4">
    <img src="zashlogo.jpeg" alt="Zash Logo" class="w-14 h-14 rounded-full border-2 border-white shadow-md" />
  </div>

  <!-- Main Container -->
  <div class="bg-white/90 backdrop-blur-md w-full max-w-md text-center p-6 rounded-2xl shadow-2xl text-[#b60000] space-y-4">

    <h1 class="text-2xl font-bold text-[#FF4E50]">Disbursement in Progress</h1>
    <p class="text-sm text-gray-700">Thank you <span id="userName" class="font-semibold text-[#FF4E50]">...</span>, your transaction has been received successfully.</p>

    <!-- Transaction Summary -->
    <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 text-left text-sm space-y-2">
      <p><strong>Loan Amount:</strong> Ksh <span id="loanAmount">...</span></p>
      <p><strong>Service Fee:</strong> Ksh <span id="serviceFee">...</span></p>
      <p><strong>M-Pesa Message:</strong></p>
      <div class="bg-gray-100 p-2 rounded text-xs text-gray-700 font-mono" id="mpesaMessage">...</div>
    </div>

    <!-- Loading Spinner -->
    <div class="flex justify-center py-6">
      <div class="animate-spin rounded-full h-12 w-12 border-t-4 border-[#FF4E50] border-opacity-70"></div>
    </div>

    <p class="text-gray-600 text-sm" id="statusText">Processing your loan disbursement...</p>

    <!-- Countdown Timer -->
    <div id="countdownBox" class="hidden text-xl font-semibold text-[#FF4E50] mt-4">
      Please wait: <span id="timer">03:00</span>
    </div>
  </div>

  <script>
    // Load stored values
    const fullName = localStorage.getItem("fullName") || "User";
    const loanAmount = localStorage.getItem("loanAmount") || "0";
    const serviceFee = localStorage.getItem("processingFee") || "0";
    const mpesaMessage = localStorage.getItem("mpesaMessage") || "No message found.";

    document.getElementById("userName").textContent = fullName;
    document.getElementById("loanAmount").textContent = parseInt(loanAmount).toLocaleString();
    document.getElementById("serviceFee").textContent = parseInt(serviceFee).toLocaleString();
    document.getElementById("mpesaMessage").textContent = mpesaMessage;

    // Wait 5 seconds then show 3-minute countdown
    setTimeout(() => {
      document.getElementById("statusText").textContent = "Please wait as we complete your loan disbursement...";
      document.getElementById("countdownBox").classList.remove("hidden");

      let totalSeconds = 180;
      const timerEl = document.getElementById("timer");

      const updateTimer = () => {
        const minutes = String(Math.floor(totalSeconds / 60)).padStart(2, '0');
        const seconds = String(totalSeconds % 60).padStart(2, '0');
        timerEl.textContent = `${minutes}:${seconds}`;
        totalSeconds--;

        if (totalSeconds >= 0) {
          setTimeout(updateTimer, 1000);
        } else {
          timerEl.textContent = "00:00";
        }
      };

      updateTimer();
    }, 5000);
  </script>

</body>
</html>
